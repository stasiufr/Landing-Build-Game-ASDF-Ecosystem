<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game of the Week | ASDF Ecosystem</title>
    <meta name="description" content="Play weekly games, compete for top scores, and earn airdrops. Token-gated gaming for $asdfasdfa holders.">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://asdfasdfa.com/games">
    <meta property="og:title" content="ASDF Game of the Week">
    <meta property="og:description" content="Weekly gaming competition for the ASDF community. Hold tokens, play games, earn rewards.">
    <meta property="og:image" content="https://asdfasdfa.com/og-games.png">
    <meta property="og:site_name" content="ASDFASDFA">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://asdfasdfa.com/games">
    <meta name="twitter:title" content="ASDF Game of the Week">
    <meta name="twitter:description" content="Weekly gaming competition for the ASDF community. Hold tokens, play games, earn rewards.">
    <meta name="twitter:image" content="https://asdfasdfa.com/og-games.png">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">

    <!-- Security -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <!-- Content Security Policy - Strict (no unsafe-inline for scripts) -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' https://unpkg.com;
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
        font-src 'self' https://fonts.gstatic.com;
        img-src 'self' data: https:;
        connect-src 'self' https://api.mainnet-beta.solana.com https://api.devnet.solana.com https://*.solana.com https://api.asdf-games.com http://localhost:3001;
        frame-ancestors 'none';
        base-uri 'self';
        form-action 'self';
    ">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/games.css">
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link" style="position: absolute; left: -9999px; top: 0; z-index: 9999; padding: 8px 16px; background: var(--accent-fire); color: #fff; text-decoration: none;">Skip to main content</a>

    <!-- ============================================
         NAVIGATION
         ============================================ -->
    <nav class="nav" role="navigation" aria-label="Main navigation">
        <div class="nav-content">
            <a href="index.html" class="nav-logo">
                <span class="nav-logo-text">ASDF</span>
            </a>

            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="learn.html">Learn</a></li>
                <li><a href="games.html" class="active">Games</a></li>
            </ul>

            <div class="nav-right">
                <span id="user-badge" class="visitor-badge" role="status" aria-live="polite">VISITOR</span>
                <button id="wallet-btn" class="wallet-btn" aria-label="Connect Phantom wallet">
                    <span id="wallet-btn-text">Connect Wallet</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- ============================================
         MAIN CONTENT
         ============================================ -->
    <main id="main-content" class="main" role="main">
        <!-- Hero Section -->
        <section class="hero">
            <div class="hero-content container">
                <div class="gotw-badge">
                    <span>GAME OF THE WEEK</span>
                </div>

                <div id="featured-game-icon" class="hero-game-icon"></div>
                <h1 id="featured-game-name">Loading...</h1>
                <p class="hero-description" id="featured-game-desc">The featured game rotates every Monday at 00:00 UTC</p>

                <div class="hero-countdown">
                    <div class="countdown-item">
                        <span id="countdown-days" class="countdown-value">0</span>
                        <span class="countdown-label">Days</span>
                    </div>
                    <div class="countdown-item">
                        <span id="countdown-hours" class="countdown-value">0</span>
                        <span class="countdown-label">Hours</span>
                    </div>
                    <div class="countdown-item">
                        <span id="countdown-mins" class="countdown-value">0</span>
                        <span class="countdown-label">Mins</span>
                    </div>
                    <div class="countdown-item">
                        <span id="countdown-secs" class="countdown-value">0</span>
                        <span class="countdown-label">Secs</span>
                    </div>
                </div>

                <div class="hero-buttons">
                    <button id="play-featured-btn" class="btn btn-primary">
                        PLAY NOW
                    </button>
                    <button id="view-all-games-btn" class="btn">
                        View All Games
                    </button>
                </div>
            </div>
        </section>

        <!-- Access Info Bar -->
        <div class="access-bar container" id="access-bar">
            <div class="access-item" id="access-gotw">
                <span class="access-icon"></span>
                <span>Game of the Week: <strong id="access-gotw-status">Available</strong></span>
            </div>
            <div class="access-item locked" id="access-all">
                <span class="access-icon"></span>
                <span>All 9 Games: <strong>Holders Only</strong></span>
            </div>
            <div class="access-item locked" id="access-tickets">
                <span class="access-icon"></span>
                <span>Competitive Mode: <strong>Holders Only</strong></span>
            </div>
        </div>

        <!-- All Games Section -->
        <section class="games-section" id="games-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">All Games</h2>
                    <p class="section-subtitle">9 unique games, 1 featured each week. Hold 1M+ $asdfasdfa to unlock all.</p>
                </div>

                <div class="games-grid" id="games-grid">
                    <!-- Games will be rendered by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Pump Arena Special Section -->
        <section class="pump-arena-section" style="padding: 60px 20px; background: linear-gradient(180deg, var(--bg-charred) 0%, rgba(234, 88, 12, 0.1) 50%, var(--bg-charred) 100%);">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title" style="display: flex; align-items: center; gap: 12px; justify-content: center;">
                        <span style="font-size: 40px;">ðŸ“ˆ</span>
                        Pump Arena
                        <span style="background: linear-gradient(90deg, var(--gold), var(--accent-fire)); padding: 4px 12px; border-radius: 20px; font-size: 12px; text-transform: uppercase;">Always Available</span>
                    </h2>
                    <p class="section-subtitle">Master the art of trading! Play classic mode or bet $asdfasdfa for real rewards.</p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px; max-width: 800px; margin: 30px auto 0;">
                    <!-- Classic Mode -->
                    <div class="game-card" style="background: linear-gradient(135deg, var(--bg-burnt) 0%, rgba(34, 197, 94, 0.1) 100%); border: 2px solid var(--green);">
                        <div class="game-icon">ðŸŽ®</div>
                        <h3 class="game-name">Classic Mode</h3>
                        <p class="game-type">Practice Trading</p>
                        <p style="font-size: 12px; color: var(--text-muted); margin: 10px 0;">Free to play. Practice your trading skills with virtual $1000. Compete for leaderboard spots!</p>
                        <button id="pump-classic-btn" class="btn game-play-btn" data-mode="classic" style="background: var(--green); border-color: var(--green-light);">
                            PLAY FREE
                        </button>
                    </div>

                    <!-- Betting Mode -->
                    <div class="game-card" style="background: linear-gradient(135deg, var(--bg-burnt) 0%, rgba(251, 191, 36, 0.1) 100%); border: 2px solid var(--gold);">
                        <div class="game-icon">ðŸ’°</div>
                        <h3 class="game-name">Betting Mode</h3>
                        <p class="game-type" style="color: var(--gold);">Bet $asdfasdfa</p>
                        <p style="font-size: 12px; color: var(--text-muted); margin: 10px 0;">Stake your $asdfasdfa tokens. Double your bet if you profit, lose it if you don't!</p>
                        <button id="pump-bet-btn" class="btn game-play-btn" data-mode="betting" style="background: var(--gold); border-color: var(--gold); color: #000;" disabled>
                            CONNECT WALLET
                        </button>
                        <p style="font-size: 10px; color: var(--text-muted); margin-top: 8px;">Min bet: 10,000 $asdfasdfa</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Pump Arena Modal -->
        <div class="game-modal" id="modal-pumparena">
            <div class="game-modal-content">
                <div class="game-modal-header">
                    <h2 class="game-modal-title">
                        <span>ðŸ“ˆ</span>
                        <span>Pump Arena</span>
                        <span id="pump-mode-badge" style="background: var(--green); padding: 4px 10px; border-radius: 12px; font-size: 12px; margin-left: 10px;">CLASSIC</span>
                    </h2>
                    <button id="close-pumparena-btn" class="game-modal-close" data-game="pumparena">&times;</button>
                </div>
                <div class="game-modal-body">
                    <div class="game-arena" id="arena-pumparena">
                        <div class="game-start-overlay" id="overlay-pumparena">
                            <div class="game-instructions">
                                <h3>Pump Arena</h3>
                                <p>Buy low, sell high on a volatile chart. Time your trades perfectly!</p>
                                <div id="pump-bet-info" style="display: none; margin-top: 15px; padding: 15px; background: rgba(251, 191, 36, 0.1); border: 1px solid var(--gold); border-radius: 8px;">
                                    <p style="color: var(--gold); font-weight: bold;">Betting Mode Active</p>
                                    <p style="font-size: 12px;">Your bet: <span id="pump-bet-amount">0</span> $asdfasdfa</p>
                                    <p style="font-size: 11px; color: var(--text-muted);">Win: 2x your bet | Lose: Lose bet</p>
                                </div>
                            </div>
                            <button id="start-pumparena-btn" class="btn btn-primary" data-game="pumparena">
                                START GAME
                            </button>
                        </div>
                    </div>
                </div>
                <div class="game-controls">
                    <div class="game-stats">
                        <div class="game-stat">
                            <div class="game-stat-value" id="score-pumparena">0</div>
                            <div class="game-stat-label">Profit</div>
                        </div>
                        <div class="game-stat">
                            <div class="game-stat-value" id="best-pumparena">0</div>
                            <div class="game-stat-label">Best</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Leaderboard Section -->
        <section class="leaderboard-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Leaderboards</h2>
                    <p class="section-subtitle">Compete for top spots and earn weekly airdrops</p>
                </div>

                <div class="leaderboard-container">
                    <!-- Weekly Leaderboard -->
                    <div class="leaderboard-card">
                        <div class="leaderboard-header">
                            <h3 class="leaderboard-title">This Week</h3>
                            <div class="leaderboard-tabs">
                                <button class="leaderboard-tab active" data-board="weekly" data-filter="featured">Featured</button>
                                <button class="leaderboard-tab" data-board="weekly" data-filter="all">All Games</button>
                            </div>
                        </div>
                        <div class="leaderboard-list" id="weekly-leaderboard">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Cycle Leaderboard -->
                    <div class="leaderboard-card">
                        <div class="leaderboard-header">
                            <h3 class="leaderboard-title">9-Week Cycle</h3>
                            <div class="leaderboard-tabs">
                                <button class="leaderboard-tab active">Total Points</button>
                            </div>
                        </div>
                        <div class="leaderboard-list" id="cycle-leaderboard">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Airdrop Info Section -->
        <section class="airdrop-section">
            <div class="container">
                <div class="airdrop-card">
                    <div class="airdrop-icon"></div>
                    <h2 class="airdrop-title">9-Week Cycle Airdrop</h2>
                    <p class="airdrop-subtitle">Compete weekly, earn airdrop slots, claim rewards every 9 weeks!</p>

                    <div class="airdrop-countdown">
                        <div class="countdown-item">
                            <span id="airdrop-weeks" class="countdown-value">0</span>
                            <span class="countdown-label">Weeks Left</span>
                        </div>
                        <div class="countdown-item">
                            <span id="airdrop-days" class="countdown-value">0</span>
                            <span class="countdown-label">Days</span>
                        </div>
                        <div class="countdown-item">
                            <span id="airdrop-hours" class="countdown-value">0</span>
                            <span class="countdown-label">Hours</span>
                        </div>
                    </div>

                    <!-- Airdrop Slots System -->
                    <div style="background: var(--bg-charred); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="font-family: var(--font-display); font-size: 16px; margin-bottom: 16px; text-align: center;">Weekly Airdrop Slots</h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; text-align: center;">
                            <div style="background: var(--bg-burnt); padding: 16px; border-radius: 8px; border: 2px solid var(--gold);">
                                <div style="font-size: 32px; margin-bottom: 8px;"></div>
                                <div style="font-size: 11px; color: var(--text-muted); text-transform: uppercase;">1st Place</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--gold);">5 Slots</div>
                            </div>
                            <div style="background: var(--bg-burnt); padding: 16px; border-radius: 8px; border: 2px solid var(--silver);">
                                <div style="font-size: 32px; margin-bottom: 8px;"></div>
                                <div style="font-size: 11px; color: var(--text-muted); text-transform: uppercase;">2nd Place</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--silver);">2 Slots</div>
                            </div>
                            <div style="background: var(--bg-burnt); padding: 16px; border-radius: 8px; border: 2px solid var(--bronze);">
                                <div style="font-size: 32px; margin-bottom: 8px;"></div>
                                <div style="font-size: 11px; color: var(--text-muted); text-transform: uppercase;">3rd Place</div>
                                <div style="font-size: 24px; font-weight: bold; color: var(--bronze);">1 Slot</div>
                            </div>
                        </div>
                        <p style="text-align: center; font-size: 11px; color: var(--text-muted); margin-top: 12px;">
                            + Donator tickets give 1/3 chance for bonus slot!
                        </p>
                    </div>

                    <div class="airdrop-rules">
                        <h4>How It Works</h4>
                        <ul>
                            <li>
                                <span class="rule-icon"></span>
                                <span>Buy competitive tickets to submit scores to the leaderboard</span>
                            </li>
                            <li>
                                <span class="rule-icon"></span>
                                <span>Each week, Top 3 players earn airdrop slots (5 + 2 + 1 = 8 slots/week)</span>
                            </li>
                            <li>
                                <span class="rule-icon"></span>
                                <span>9 games rotate weekly - full cycle = 9 weeks</span>
                            </li>
                            <li>
                                <span class="rule-icon"></span>
                                <span>Airdrop distributed at end of each 9-week cycle</span>
                            </li>
                            <li>
                                <span class="rule-icon"></span>
                                <span>Prize pool = ticket sales accumulated over the cycle</span>
                            </li>
                            <li>
                                <span class="rule-icon"></span>
                                <span>Rewards proportional to total slots earned</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Test Mode Button (Fixed) -->
    <button id="test-mode-btn" class="btn" style="position: fixed; bottom: 20px; left: 20px; z-index: 50; font-size: 11px; padding: 8px 16px;">
        TEST MODE: OFF
    </button>

    <!-- Tickets Bar (Fixed) -->
    <div class="tickets-bar" id="tickets-bar">
        <div class="tickets-count">
            <span id="ticket-count">No active ticket</span>
        </div>
        <button id="buy-tickets-btn" class="btn buy-tickets-btn">Buy Tickets</button>
    </div>

    <!-- Game Modals Container -->
    <div id="game-modals">
        <!-- Modals will be generated by JavaScript -->
    </div>

    <!-- Ticket Purchase Modal -->
    <div class="game-modal" id="ticket-modal">
        <div class="game-modal-content" style="max-width: 700px;">
            <div class="game-modal-header">
                <h2 class="game-modal-title">
                    <span></span>
                    <span>Buy Competitive Tickets</span>
                </h2>
                <button id="close-ticket-modal-btn" class="game-modal-close">&times;</button>
            </div>
            <div class="game-modal-body" style="padding: 24px;">
                <p style="text-align: center; color: var(--text-muted); margin-bottom: 24px;">
                    Purchase tickets to compete on the leaderboard and earn airdrop slots!
                </p>

                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                    <!-- Standard Ticket -->
                    <div class="ticket-card" style="background: var(--bg-burnt); border: 2px solid var(--border-rust); border-radius: 12px; padding: 20px; text-align: center;">
                        <div style="font-size: 40px; margin-bottom: 12px;"></div>
                        <h3 style="font-family: var(--font-display); font-size: 18px; margin-bottom: 8px;">Standard</h3>
                        <div style="font-size: 24px; font-weight: bold; color: var(--gold); margin-bottom: 8px;">$5.52</div>
                        <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 16px;">30 min real-time<br>Competitive mode</p>
                        <button class="btn buy-ticket-btn" data-ticket="standard" style="width: 100%;">Buy</button>
                    </div>

                    <!-- Premium Ticket -->
                    <div class="ticket-card" style="background: var(--bg-burnt); border: 2px solid var(--purple); border-radius: 12px; padding: 20px; text-align: center; position: relative;">
                        <div style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: var(--purple); color: #fff; font-size: 10px; font-weight: bold; padding: 4px 12px; border-radius: 100px;">POPULAR</div>
                        <div style="font-size: 40px; margin-bottom: 12px;"></div>
                        <h3 style="font-family: var(--font-display); font-size: 18px; margin-bottom: 8px; color: var(--purple);">Premium</h3>
                        <div style="font-size: 24px; font-weight: bold; color: var(--purple); margin-bottom: 8px;">$55.20</div>
                        <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 16px;">300 min in-game<br>Pause anytime</p>
                        <button class="btn buy-ticket-btn" data-ticket="premium" style="width: 100%; background: var(--purple); border-color: var(--purple);">Buy</button>
                    </div>

                    <!-- Donator Ticket -->
                    <div class="ticket-card" style="background: linear-gradient(135deg, var(--bg-burnt), rgba(251, 191, 36, 0.1)); border: 2px solid var(--gold); border-radius: 12px; padding: 20px; text-align: center; position: relative;">
                        <div style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: var(--gold); color: #000; font-size: 10px; font-weight: bold; padding: 4px 12px; border-radius: 100px;">BEST VALUE</div>
                        <div style="font-size: 40px; margin-bottom: 12px;"></div>
                        <h3 style="font-family: var(--font-display); font-size: 18px; margin-bottom: 8px; color: var(--gold);">Donator</h3>
                        <div style="font-size: 24px; font-weight: bold; color: var(--gold); margin-bottom: 8px;">$552</div>
                        <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 8px;">Full week access</p>
                        <p style="font-size: 11px; color: var(--gold); margin-bottom: 16px;">+ 1/3 chance bonus airdrop slot!</p>
                        <button class="btn buy-ticket-btn" data-ticket="donator" style="width: 100%; background: var(--gold); border-color: var(--gold); color: #000;">Buy</button>
                    </div>
                </div>

                <p style="text-align: center; color: var(--text-muted); font-size: 11px; margin-top: 20px;">
                    Prices are in $asdfasdfa equivalent. Payments processed on Solana blockchain.
                </p>
            </div>
        </div>
    </div>

    <!-- Pack Opening Modal -->
    <div class="game-modal" id="pack-modal">
        <div class="game-modal-content" style="max-width: 500px; background: transparent; border: none; box-shadow: none;">
            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 400px;">
                <!-- Pack Card -->
                <div id="pack-card" class="pack-card" style="width: 200px; height: 280px; background: linear-gradient(135deg, var(--gold), #f59e0b); border-radius: 16px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; transition: transform 0.6s; transform-style: preserve-3d; box-shadow: 0 20px 60px rgba(251, 191, 36, 0.4);">
                    <div style="font-size: 60px; margin-bottom: 16px;"></div>
                    <div style="font-family: var(--font-display); font-size: 20px; color: #000; font-weight: bold;">DONATOR PACK</div>
                    <div style="font-size: 14px; color: rgba(0,0,0,0.6); margin-top: 8px;">Tap to reveal!</div>
                </div>

                <!-- Result Display -->
                <div id="pack-result" style="display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 40px;">
                    <!-- Content will be inserted by JS -->
                </div>

                <button id="close-pack-modal-btn" class="btn" style="margin-top: 30px;">Continue</button>
            </div>
        </div>
    </div>

    <!-- ============================================
         JAVASCRIPT
         ============================================ -->
    <!-- Solana Web3.js for blockchain transactions (with Subresource Integrity) -->
    <script src="https://unpkg.com/@solana/web3.js@1.87.6/lib/index.iife.min.js"
            integrity="sha384-frt8Dafwfh70NeaBS1T4CRjuekut3aQwBwRGErSdQ+htbmU6sT8P2lc07CA03Kix"
            crossorigin="anonymous"></script>

    <!-- ASDF Games - Modular Architecture -->
    <script src="js/games/utils.js"></script>
    <script src="js/games/config.js"></script>
    <script src="js/games/solana.js"></script>
    <script src="js/games/api.js"></script>
    <script src="js/games/state.js"></script>
    <script src="js/games/ui.js"></script>
    <script src="js/games/engine.js"></script>
    <script src="js/games/main.js"></script>
</body>
</html>
